<VirtualHost *:80>
    RewriteEngine On
    # Block /token
    RedirectMatch 302 ^/oauth/callback$ /index.html

    # Simulate:
    # - Token refresh does not work due to revoked token or wrong client_secret
    # - Token exchange does not work due invalid request (e.g. wrong code_verifier)
    #RewriteRule ^(.*/)?token$ - [R=401,L]

    # Simulate:
    # - "GET favorites" does not work due to revoked token or wrong client_secret
    #RewriteCond %{QUERY_STRING} ^favorited=
    #RewriteRule ^ - [R=401,L]

    # Proxy everything else
    ProxyPreserveHost On
    ProxyPass / https://api.events.ccc.de/
    ProxyPassReverse / https://api.events.ccc.de/
    SSLProxyEngine On
    SSLProxyVerify none # we disable, because we trust
    SSLProxyCheckPeerName off
</VirtualHost>